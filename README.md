<h1 align="center">
  <img alt="ALT logo" src="https://github.com/alexminator/ALT_nano/blob/master/img/ALT_logo.png" width="300px"/><br/><strong>Another Level Tank</strong>
  
  <a href="https://github.com/alexminator/ALT_nano/blob/master/README_es.md">
    <img height="20px" src="https://img.shields.io/badge/ES-flag.svg?color=555555&style=flat-square&logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA3NTAgNTAwIj4NCjxwYXRoIGZpbGw9IiNjNjBiMWUiIGQ9Im0wLDBoNzUwdjUwMGgtNzUweiIvPg0KPHBhdGggZmlsbD0iI2ZmYzQwMCIgZD0ibTAsMTI1aDc1MHYyNTBoLTc1MHoiLz4NCjwvc3ZnPg0K">
  </a>
  <a href="https://github.com/alexminator/ALT_nano/blob/master/README.md">
    <img height="20px" src="https://img.shields.io/badge/EN-flag.svg?color=555555&style=flat-square&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgNjAgMzAiIGhlaWdodD0iNjAwIj4NCjxkZWZzPg0KPGNsaXBQYXRoIGlkPSJ0Ij4NCjxwYXRoIGQ9Im0zMCwxNWgzMHYxNXp2MTVoLTMwemgtMzB2LTE1enYtMTVoMzB6Ii8+DQo8L2NsaXBQYXRoPg0KPC9kZWZzPg0KPHBhdGggZmlsbD0iIzAwMjQ3ZCIgZD0ibTAsMHYzMGg2MHYtMzB6Ii8+DQo8cGF0aCBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iNiIgZD0ibTAsMGw2MCwzMG0wLTMwbC02MCwzMCIvPg0KPHBhdGggc3Ryb2tlPSIjY2YxNDJiIiBzdHJva2Utd2lkdGg9IjQiIGQ9Im0wLDBsNjAsMzBtMC0zMGwtNjAsMzAiIGNsaXAtcGF0aD0idXJsKCN0KSIvPg0KPHBhdGggc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjEwIiBkPSJtMzAsMHYzMG0tMzAtMTVoNjAiLz4NCjxwYXRoIHN0cm9rZT0iI2NmMTQyYiIgc3Ryb2tlLXdpZHRoPSI2IiBkPSJtMzAsMHYzMG0tMzAtMTVoNjAiLz4NCjwvc3ZnPg0K">
  </a>
</h1>

<a name="readme-top"></a>

<h1 align="center">
  
[![GitHub repo size](https://img.shields.io/github/repo-size/alexminator/ALT_nano?logo=github&style=plastic)](https://github.com/alexminator/ALT_nano/)
[![GitHub License](https://img.shields.io/github/license/alexminator/ALT_nano.svg?logo=github&style=plastic&colorB=68B7EB)](https://github.com/alexminator/ALT_nano/blob/master/LICENSE)
[![GitHub stars](https://img.shields.io/github/stars/alexminator/ALT_nano.svg?style=plastic&logo=github&color=yellow)](https://github.com/alexminator/ALT_nano/stargazers) 
[![GitHub forks](https://img.shields.io/github/forks/alexminator/ALT_nano.svg?logo=github&color=teal&style=plastic)](https://github.com/alexminator/ALT_nano/network/members)
[![GitHub top language](https://img.shields.io/github/languages/top/alexminator/ALT_nano?logo=github&style=plastic&color=blueviolet)](https://github.com/alexminator/ALT_nano/)
[![GitHub contributors](https://img.shields.io/github/contributors/alexminator/ALT_nano?logo=github&style=plastic)](https://github.com/alexminator/ALT_nano/)
[![Watchers](https://img.shields.io/github/watchers/alexminator/ALT_nano?logo=github&color=teal&style=plastic)](https://github.com/alexminator/ALT_nano/watchers)  
</h1> 

<h4 align="center">:star: Give me one star â€” it will motivate me to keep improving it!!</h4>

<!-- TABLE OF CONTENTS -->
<details>
  <summary>Table of contents</summary>
  <ol>
    <li>
      <a href="#about-the-project">About the Project</a>
      <ul>
        <li><a href="#goals-of-this-project-">Goals of this project</a></li>
      </ul>
    </li>
    <li>
      <a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#component">Component</a></li>
        <li><a href="#instalation">Instalation</a></li>
        <li><a href="#diagram">Diagram</a></li>
        <li><a href="#code">Code</a></li>
      </ul>
    </li>
    <li><a href="#collaborator">Collaborator</a></li>
    <li><a href="#license">License</a></li>
    <li><a href="#contact">Contact</a></li>
    <li><a href="#open-source-programs">Open Source Programs</a></li>
    <li><a href="#special-thanks">Special thanks</a></li>
  </ol>
</details>

<!-- ABOUT THE PROJECT -->
## About the Project

*This project is one more version of a tank water level monitor. The water monitoring system is a liquid level measurement system to keep the user alerted in case of liquid overflow or when the tank runs out. An ultrasonic sensor will be fixed, which will be placed on the tank pointing at the liquid. The ultrasonic sensor is used to measure, compare the depth of the container and the liquid level.
System status can be monitored via an LCD display and a buzzer sounds when the limit exceeds the allowable fill amount or falls below a set limit. Through the button we can silence the alarms with a long press and also turn on the LCD backlight for better vision with a short press.*

**You can view the demo [here](https://wokwi.com/projects/356392498196222977).**
> **Warning** :
Once inside of WOKWI web press the PLAY button to start the simulation. When the simulation starts the high level alarm will sound. Long press the button until the alarm is silenced. Click on the ultrasonic sensor and a slider will appear to simulate the reading values of the sensor. Vary the values between 25 and 104 cm to see the tank fill animation. Where 25 cm is a full tank and 104 cm (tank height) is totally empty. The JSN-SR04T sensor has a dead zone of 25 cm.

### Goals of this project :

- **_24/7 tank level monitoring_**
- **_Avoid spillage of water due to overflow_**
- **_Prevent the tank from being empty and leaving the house without a water supply_**

<a href="#readme-top"><img align="right" border="0" src="https://github.com/alexminator/ALT_nano/blob/master/img/up_arrow.png" width="22" ></a>

---

<!-- GETTING STARTED -->
## Getting Started

[![Arduino](https://img.shields.io/badge/Arduino-Project-teal.svg?colorA=teal&colorB=red&style=for-the-badge)](https://github.com/alexminator/ALT_nano/)

```js
         .8.          8 8888         8888888 8888888888
        .888.         8 8888               8 8888
       :88888.        8 8888               8 8888
      . `88888.       8 8888               8 8888
     .8. `88888.      8 8888               8 8888
    .8`8. `88888.     8 8888               8 8888
   .8' `8. `88888.    8 8888               8 8888
  .8'   `8. `88888.   8 8888               8 8888
 .888888888. `88888.  8 8888               8 8888
.8'       `8. `88888. 8 888888888888       8 8888

```
### Component

*For this project I used an Arduino nano due to its small size, to which a sensor and actuators will be connected. To display the information, a 20x4 LCD display was chosen with enough space to draw an animation of the tank filling. A buzzer for notification and a button for control.For a longer life of the ultrasonic sensor, the **JSN-SR04T** was chosen, which is waterproof. If you do not have this sensor and use another, make sure to protect it against moisture.*

The Arduino(Hardware) components required are:

- **Arduino Nano**
- **LCD screen 20x4**
- **A button**
- **A buzzer**
- **A 10k resistor**
- **A waterproof ultrasonic sensor [JSN-SR04T](https://naylampmechatronics.com/img/cms/Datasheets/JSN-SR04T-2-0.pdf)**

<a href="#readme-top"><img align="right" border="0" src="https://github.com/alexminator/ALT_nano/blob/master/img/up_arrow.png" width="22" ></a>

---

### Instalation

*Below is the connection diagram and a table with the pins to be connected.*

| ARDUINO PINS | LCD PINS    |  
| ------------ | ----------- | 
|  12-  `D12`  |   15 - `A`  |
|  11-  `D11`  |   4 - `RS`  |
|  10-  `D10`  |   6 - `E`   |
|  9-  `D9`    |   11 - `D4` |
|  8-  `D8`    |   12 - `D5` |
|  7-  `D7`    |   13 - `D6` |
|  6-  `D6`    |   14 - `D7` |
|    GND       |   16 - `K`  |
|    GND       |   1 - `VSS` |
|   VCC(5v)    |   2 - `VDD` |
| ARDUINO PINS | BUTTON PINS | 
|  3-  `D3`    |   1 - 3     | 
|    GND       |   2 - 4     |  
| ARDUINO PINS | BUZZER PINS |
|  4-  `D4`    |     +       |
|    GND       |     -       |
| ARDUINO PINS | JSN-SR04T   |
|  2-  `D2`    |  `TRIGGER`  |
|  3-  `D5`    |   `ECHO`    |
|   VCC(5v)    |    VCC      |
|    GND       |    GND      |

> **Warning** :
From pin 1-3 of the button connect a 10k resistor to VCC (5v).

### Diagram

![Diagram](https://github.com/alexminator/ALT_nano/blob/master/img/diagrama.jpg?raw=true)

> ### :point_right: You can find the diagram [here](https://github.com/alexminator/ALT_nano/blob/master/img/ALT-UNO.fzz). :star:

<a href="#readme-top"><img align="right" border="0" src="https://github.com/alexminator/ALT_nano/blob/master/img/up_arrow.png" width="22" ></a>
---

## Code
*The code consists of a local library called Tank that is in charge of drawing the tank on the screen. Only a global **LiquidCrystal** library was used for display management. If you have a screen with I2C, you should replace this library with **LiquidCrystal_I2C** and initialize it in a different way than it is in the project, keeping the name as lcd.
The rest of the libraries are for handling alarms, alarm tones, tank filling animation, measurement filter, code debugging and font.
To activate the debugger, the code should look like this:*
```c
#define DEBUGLEVEL DEBUGLEVEL_DEBUGGING
//#define DEBUGLEVEL DEBUGLEVEL_NONE
```
*You can vary the debugging level if you wish, by referring to the debug.h library and choosing the level you need.
Button, Sensor, and Draw objects are created. The Button object handles the control of the button, which is used to silence high and low level alarms and turn on the screen backlight. The sensor object returns the distance measured by the ultrasonic sensor to be used in the calculation of the volume and the level of the liquid column in percent. Finally the draw object will draw each of the 8 possible glyphs that can be used to generate the tank fill animation.*

*The ultrasonic sensor measures the amount of empty space in the tank, that is, the distance between it and the water contained in the tank. Therefore, if we know the height of the empty tank **(H)**, by subtracting the distance **(D)** from empty space we will know the height of the liquid column **(C)** that it has. Look at the figure below.*

<td align="center"><img src="https://github.com/alexminator/ALT_nano/blob/master/img/fig%202.png" width=500px height=500px alt="fig2"/></td>

*To calculate the volume of the tank, its measurements must be taken into account; they are entered as constants in the code.*

> **Warning** :
It should be noted that the tank for which this code was created is atypical. It is a rectangular tank that has a partition in the middle and makes it 2 tanks. Due to this particular, the volume of the partition up to the height of the liquid column is also calculated to be later subtracted from the general volume and as a result the actual volume of liquid in the tank.

*If you want to use this code to calculate the volume of liquid in your tank, you must modify the parts of the code that calculate volume that are in the get_volume function. You only have to take into account if your tank is cylindrical or rectangular and use the corresponding formula.
I leave this [link](https://www.calculatorsoup.com/calculators/construction/tank.php) to a website for calculating the volume of tanks.*

*The most important constants to keep in mind are:*
```c
#define DIST_TOPE    //height of the tank in cm measured with the tank empty.
const int NIVEL_BAJO //low percentage level from which the alarm is activated
const int NIVEL ALTO //high percentage level from which the alarm is activated.
```
*The height of the tank should not exceed the maximum distance that your ultrasonic sensor can measure. Set a low level according to your tank fill needs. The high level is usually defined as close to 100%.*

> **Warning** :
Even if the high level is defined as 100% and this level is reached, this does not mean that your tank will overflow. The waterproof ultrasonic sensor has a 25 cm measurement dead zone in which readings are unreliable. This is taken into account in the code so 100% would be the height of the tank minus 25 cm of dead range. This would be taking into account that the sensor is positioned at the height of the tank. If it is set higher be careful to define the high level for the alarm. See figure below.

<td align="center"><img src="https://github.com/alexminator/ALT_nano/blob/master/img/fig1.png" alt="fig2"/></td>

<a href="#readme-top"><img align="right" border="0" src="https://github.com/alexminator/ALT_nano/blob/master/img/up_arrow.png" width="22" ></a>

---

## Collaborator

<table style="width:100%">
  <tr>
    <th><b>Alexminator</b></th>
    <th><b>20-EverGreen-2</b></th>
    
  </tr>
  <tr>
    <td align="center"><a href="https://github.com/alexminator"><img src="https://avatars.githubusercontent.com/u/9116486?s=400&v=4" width=150px height=150px alt="alexminator"/></a></td>
    <td align="center"><a href="https://github.com/20-EverGreen-2"><img src="https://avatars.githubusercontent.com/u/84293898?v=4" width="100px;" alt="20-EverGreen-2"></a></td>
    
  </tr>
  <tr>
    <td align="center"><a href="https://twitter.com/alexminator99"><img src="img/twitter-48.png" width="32px" height="32px"></a> <a href="https://www.facebook.com/alexander.rivasalpizar/"><img src="img/facebook-48.png" width="32px" height="32px"></a> <a href="https://www.linkedin.com/in/alexander-rivas-73532037/"><img src="img/linkedin-48.png" width="32px" height="32px"></a><a href="https://t.me/Alexminator"><img src="img/telegram-app-48.png" width="32px" height="32px"></a></td>
    <td align="center"><a href="https://t.me/Deltatronics"><img src="img/telegram-app-48.png" width="32px" height="32px"></a></td>
    
  </tr>
</table>

## License

*The ALT project is released under the <a href="https://github.com/alexminator/ALT_nano/blob/master/LICENSE.md">MIT</a> license.*

## Contact

> **_Need help?_** 
**_Feel free to contact me ðŸ“¨ [alexminator99@gmail.com](mailto:alexminator99@gmail.com?Subject=ALT_nano_issues)_**

[![GitHub followers](https://img.shields.io/github/followers/alexminator.svg?label=Follow%20@alexminator&style=social)](https://github.com/alexminator/) [![Twitter Follow](https://img.shields.io/twitter/follow/alexminator?style=social)](https://twitter.com/alexminator99)

## Open Source Programs
* [VSCODE](https://code.visualstudio.com/) -A source code editor.
* [PlatFormio](https://platformio.org/) - Open programming IDE for C/C++, hardware oriented.

## Special thanks
* _To the Cuban Arduino community._
* _To everyone who gave me his help when I had doubts, especially my son._

<a href="#readme-top"><img align="right" border="0" src="https://github.com/alexminator/ALT_nano/blob/master/img/up_arrow.png" width="22" ></a>

---
